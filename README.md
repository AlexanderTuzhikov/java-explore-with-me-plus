# java‑explore‑with‑me‑plus

## Feature: Комментарии

### Описание

Контроллер `PrivateUserCommentController` обрабатывает CRUD‑операции с комментариями зарегистрированных пользователей.

---

### Endpoints

#### 1. Добавление комментария к событию

**Метод:** `POST`  
**Путь:** `/users/{userId}/event/{eventId}/comment`

**Описание:**  
Добавляет комментарий пользователя к указанному событию.

**Требования:**
- Пользователь должен быть зарегистрирован (`404 Not Found`, если нет).
- Событие должно существовать и быть в статусе `PUBLISHED` (`404 Not Found` для удалённых, `409 Conflict` для `PENDING`/`CANCELLED`).
- Текст комментария: **10–2000 символов** (`409 Conflict` при нарушении).
- Новый комментарий получает статус `PENDING` и ждет модерации администратором

**Request Body (JSON):**
```json
{
  "comment": "Текст коммента"
}
```
**Response Body (JSON, 201 Created):**
```json
{
  "id": 1,
  "author": {
    "id": 1,
    "name": "Author Name"
  },
  "eventId": 1,
  "comment": "Comment text",
  "createdOn": "2026-02-04 17:07:11",
  "state": "PENDING",
  "publishedOn": null
}
```

#### 2. Удаление комментария к событию

**Метод:** `DELETE`  
**Путь:** `/users/{userId}/comment/{commentId}`

**Описание:**  
Удаляет комментарий пользователя к указанному событию.

**Требования:**
- Пользователь должен быть зарегистрирован (`404 Not Found`, если нет).
- Событие должно существовать и быть в статусе `PUBLISHED` (`404 Not Found` для удалённых, `409 Conflict` для `PENDING`/`CANCELLED`).
- Пользователь должен быть автором удаляемого комментария (`409 Conflict`)

**Request Body (JSON):**
```json

```
**Response Body (JSON, 204 No Content):**
```json

```

#### 3. Обновление комментария к событию

**Метод:** `PATCH`  
**Путь:** `/users/{userId}/comment/{commentId}`

**Описание:**  
Редактирует комментарий пользователя к указанному событию.

**Требования:**
- Пользователь должен быть зарегистрирован (`404 Not Found`, если нет).
- Событие должно существовать и быть в статусе `PUBLISHED` (`404 Not Found` для удалённых, `409 Conflict` для `PENDING`/`CANCELLED`).
- Пользователь должен быть автором изменяемого комментария (`409 Conflict`)
-  Обновленный комментарий получает статус `PENDING`, сбрасывается дата публикации и ждет модерации администратором

**Request Body (JSON):**
```json
{
  "comment": "Обновленный текст комментария"
}
```
**Response Body (JSON, 200 OK):**
```json
{
  "id": 1,
  "author": {
    "id": 1,
    "name": "Author Name"
  },
  "eventId": 1,
  "comment": "Обновленный текст комментария",
  "createdOn": "2026-02-04 17:07:11",
  "state": "PENDING",
  "publishedOn": null
}
```
#### 4. Получение комментария пользователя

**Метод:** `GET`  
**Путь:** `/users/{userId}/comment/{commentId}`

**Описание:**  
Находит комментарий пользователя по ID комментария.

**Требования:**
- Пользователь должен быть зарегистрирован (`404 Not Found`, если нет).
- Комментарий не должен быть удален (`404 Not Found`, если нет).
- Пользователь должен быть автором комментария (`409 Conflict`)

**Request Body (JSON):**
```json

```
**Response Body (JSON, 200 OK):**
```json
{
  "id": 1,
  "author": {
    "id": 1,
    "name": "Author Name"
  },
  "eventId": 1,
  "comment": "Обновленный текст комментария",
  "createdOn": "2026-02-04 17:07:11",
  "state": "PENDING",
  "publishedOn": null
}
```

#### 5. Получение комментариев пользователя

**Метод:** `GET`  
**Путь:** `/users/{userId}
**Параметры запроса:**
- `from` — смещение (номер элемента, с которого начинается выборка) по умолчанию `0`.
- `size` — количество элементов в ответе (размер страницы) по умолчанию `10`..

**Описание:**  
Находит комментарии пользователя автором которых он является с сортировкой по самым новым.

**Требования:**
- Пользователь должен быть зарегистрирован (`404 Not Found`, если нет).

**Request Body (JSON):**
```json

```
**Response Body (JSON, 200 OK):**
```json
[
  {
    "id": 2,
    "author": {
      "id": 1,
      "name": "Author Name"
    },
    "eventId": 2,
    "comment": "Новый комментарий",
    "createdOn": "2026-02-04 17:20:11",
    "state": "PENDING",
    "publishedOn": null
  },
  {
    "id": 1,
    "author": {
      "id": 1,
      "name": "Author Name"
    },
    "eventId": 1,
    "comment": "Обновленный текст комментария",
    "createdOn": "2026-02-04 17:07:11",
    "state": "PENDING",
    "publishedOn": null
  }
]
```

